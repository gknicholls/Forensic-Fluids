---
title: Test the likelihood calculation integrated across all partiions within a marker
  group for a given subtype
output:
  pdf_document: default
  html_notebook: default
---

# Preliminaries

```{r setwd}
setwd("/Users/chwu/Documents/research/bfc/github/Forensic-Fluids/")

```


```{r load_lib}
library(salso)
source("forensicFunctions.R")
```

```{r load_data}
load("allParts5And7EltsMatsAndSets.rda")

singleTypeFilePath = "data.csv"
single.df = read.csv(singleTypeFilePath, header = TRUE) # whole single sample data
slv.df = single.df[single.df$Sample == 3,] # saliva
dim(slv.df)

sample.df = slv.df[,-1] # single sample data, delete the index column
dim(sample.df)
```

# Partition with three elements

```{r ex1_enum_part}
enumerate.partitions(3)
# [,1] [,2] [,3]
# [1,]    1    1    1
# [2,]    1    1    2
# [3,]    1    2    1
# [4,]    1    2    2
# [5,]    1    2    3
```

```{r ex1_row_sampling}
set.seed(222)
kmeansClust3Index = c(1, 3, 1, 2, 2, 2, 2, 2, 2, 
                      3, 3, 2, 3, 2, 3, 2, 2, 1, 
                      3, 2, 3, 1, 2, 2, 2, 2, 2, 
                      3, 2, 3, 2, 1, 2, 3, 2, 1, 
                      2, 1, 1, 2, 2, 2, 2, 2, 2, 
                      2, 3, 2, 2, 1, 1, 1, 2, 2, 
                      3, 3, 3, 3, 3, 2, 3, 3, 3, 
                      3, 2, 2, 2, 2, 3, 3, 1, 2, 
                      1, 1, 1, 1, 1, 1, 3, 3, 1)
slvClust1ExIndx = sample(which(kmeansClust3Index==1), 2)
# 180 183 
#  75  78
slvClust2ExIndx = sample(which(kmeansClust3Index==2), 5)
# 146 147 145 121 122 
#  41  42  40  16  17 
slvClust3ExIndx = sample(which(kmeansClust3Index==3), 3)
# 185 162 126 
#  80  57  21

rowExIndx = c(slvClust1ExIndx, slvClust2ExIndx, slvClust3ExIndx)
sample.df[rowExIndx ,1:5]
```

```{r ex1_col_sampling}
colExIndx = c(1,2,5)
slvEx1.df = sample.df[rowExIndx, c("CYP", "HBD1", "MUC4")]
slvEx1.df
```

## Partition 1

Partition: (1, 1, 1)

```{r ex1_part1_clust1}
prod(dim(slvEx1.df))
sum(slvEx1.df)
prod(dim(slvEx1.df)) - sum(slvEx1.df)


```

```{r ex1_part1_calc_lik}
ex1.expt1 = sum(log(1:9)) - sum(log(25:34))
ex1.ans1 = log(calcLikIntAllPart(eltsAllPartSet = list(list(c(1, 2, 3))), 
                             sample = slvEx1.df, 
                             alphaC = 2, 
                             betaC = 3))
ex1.expt1
ex1.ans1
ex1.expt1 - ex1.expt1
abs(ex1.expt1 - ex1.expt1) < 1e-10
```

```{r ex1_part1_calc_mdp}
ex1.mdp.expt1 = 15/(7 * 13)
ex1.mdp.ans1 = calcLogMDPColPrior(alpha = 12, setList = list(c(1,1,1)), setCountMax = 3)

(ex1.mdp.expt1 - ex1.mdp.ans1)/max(c(ex1.mdp.expt1, ex1.mdp.ans1))
abs((ex1.mdp.expt1 - ex1.mdp.ans1)/max(c(ex1.mdp.expt1, ex1.mdp.ans1))) < 1e-10
```

## Partition 2

Partition: (1, 1, 2)

```{r ex1_part2_clust1}
prod(dim(slvEx1.df[, 1:2]))
sum(slvEx1.df[, 1:2])
prod(dim(slvEx1.df[, 1:2])) - sum(slvEx1.df[, 1:2])
```

```{r ex1_part2_clust2}
length(slvEx1.df[, 3])
sum(slvEx1.df[, 3])
```

```{r ex1_part2_calc_lik}
length(slvEx1.df[, 3]) - sum(slvEx1.df[, 3])

ex1.expt2 = (sum(log(1:4)) - sum(log(20:24))) + (sum(log(1:6)) - sum(log(8:14)))

ex1.ans2 = log(calcLikIntAllPart(eltsAllPartSet = list(list(c(1, 2), c(3))), 
                  sample = slvEx1.df, 
                  alphaC = 2, 
                  betaC = 3))

ex1.expt2
ex1.ans2
ex1.expt2 - ex1.expt2
abs(ex1.expt2 - ex1.expt2) < 1e-10
```

```{r ex1_part2_calc_mdp}
ex1.mdp.expt2 = 20/(7 * 13)
ex1.mdp.ans2 = calcLogMDPColPrior(alpha = 12, setList = list(c(1,1), c(3)), setCountMax = 3)

abs(ex1.mdp.expt2 - ex1.mdp.ans2)/max(c(ex1.mdp.expt2, ex1.mdp.ans2))
abs((ex1.mdp.expt2 - ex1.mdp.ans2)/max(c(ex1.mdp.expt2, ex1.mdp.ans2))) < 1e-10
```

## Partition 3

Partition: (1, 2, 1)

```{r ex1_part3_clust1}
prod(dim(slvEx1.df[, c(1,3)]))
sum(slvEx1.df[, c(1,3)])
```

```{r ex1_part3_clust2}
length(slvEx1.df[, 2]) - sum(slvEx1.df[, 2])
```

```{r ex1_part3_calc_lik}
ex1.expt3 = ((sum(log(1:7)) - sum(log(17:24)))) + 
  ((sum(log(1:3)) - sum(log(11:14))))
ex1.ans3 = calcLikIntAllPart(eltsAllPartSet = list(list(c(1, 3), c(2))), 
                  sample = slvEx1.df, 
                  alphaC = 2, 
                  betaC = 3)
ex1.expt3 - ex1.ans3
ex1.expt3 
ex1.ans3
abs(ex1.expt3 - ex1.expt3) < 1e-10
```

```{r ex1_part3_calc_mdp}
ex1.mdp.expt3 = 20/(7 * 13)
ex1.mdp.ans3 = calcLogMDPColPrior(alpha = 12, 
                                  setList = list(c(1,3), c(2)), 
                                  setCountMax = 3)

abs(ex1.mdp.expt3 - ex1.mdp.ans3)/max(c(ex1.mdp.expt3, ex1.mdp.ans3))
abs((ex1.mdp.expt3 - ex1.mdp.ans3)/max(c(ex1.mdp.expt3, ex1.mdp.ans3))) < 1e-10
```

# Partition 4

Partition: (1, 2, 2)

```{r ex1_part4_clust1}
# 1    2    2
length(slvEx1.df[, 1])
sum(slvEx1.df[, 1])
```

```{r ex1_part4_clust2}
prod(dim(slvEx1.df[, c(2,3)]))
sum(slvEx1.df[, c(2,3)])
```

```{r ex1_part4_calc_lik}
ex1.expt4 = -sum(log(c(6, 13, 14))) + 
  ((sum(log(1:8)) - sum(log(16:24))))
ex1.ans4 = log(calcLikIntAllPart(eltsAllPartSet = list(list(c(1), c(2, 3))), 
                         sample = slvEx1.df, 
                         alphaC = 2, 
                         betaC = 3))
ex1.expt4
ex1.ans4
ex1.expt4 - ex1.ans4
abs(ex1.expt4 - ex1.ans4) < 1e-10
```

```{r ex1_part4_calc_mdp}
ex1.mdp.expt4 = 20/(7 * 13)
ex1.mdp.ans4 = calcLogMDPColPrior(alpha = 12, 
                                  setList = list(c(2,3), c(1)), 
                                  setCountMax = 3)

abs(ex1.mdp.expt4 - ex1.mdp.ans4)/max(c(ex1.mdp.expt4, ex1.mdp.ans4))
abs((ex1.mdp.expt4 - ex1.mdp.ans4)/max(c(ex1.mdp.expt4, ex1.mdp.ans4))) < 1e-10
```


# Partition 5

Partition: (1, 2, 3)

```{r ex1_part5_clust1}
length(slvEx1.df[, 1])
sum(slvEx1.df[, 1])
```

```{r ex1_part5_clust2}
length(slvEx1.df[, 2])
sum(slvEx1.df[, 2])
```

```{r ex1_part5_clust3}
length(slvEx1.df[, 3])
sum(slvEx1.df[, 3])
```

```{r ex1_part5_calc_lik}
ex1.expt5 = (-sum(log(c(6, 13, 14)))) + 
  -sum(log(c(2, 11, 13, 14))) + 
  (sum(log(1:6)) - sum(log(c(8:14))))
ex1.ans5 = calcLikIntAllPart(eltsAllPartSet = list(list(c(1), c(2), c(3))), 
                         sample = slvEx1.df, 
                         alphaC = 2, 
                         betaC = 3)
ex1.expt5
ex1.ans5
ex1.expt5 - ex1.ans5
abs(ex1.expt5 - ex1.ans5) < 1e-10
```


```{r ex1_part5_calc_mdp}
ex1.mdp.expt5 = 16/(7 * 13)
ex1.mdp.ans5 = calcLogMDPColPrior(alpha = 12, 
                                  setList = list(c(1), c(2), c(3)), 
                                  setCountMax = 3)

abs(ex1.mdp.expt5 - ex1.mdp.ans5)/max(c(ex1.mdp.expt5, ex1.mdp.ans5))
abs((ex1.mdp.expt5 - ex1.mdp.ans5)/max(c(ex1.mdp.expt5, ex1.mdp.ans5))) < 1e-10
```

# Partition with four elements

```{r}
enumerate.partitions(4)
#       [,1] [,2] [,3] [,4]
#  [1,]    1    1    1    1
#  [2,]    1    1    1    2
#  [3,]    1    1    2    1
#  [4,]    1    1    2    2
#  [5,]    1    1    2    3
#  [6,]    1    2    1    1
#  [7,]    1    2    1    2
#  [8,]    1    2    1    3
#  [9,]    1    2    2    1
# [10,]    1    2    2    2
# [11,]    1    2    2    3
# [12,]    1    2    3    1
# [13,]    1    2    3    2
# [14,]    1    2    3    3
# [15,]    1    2    3    4
```

```{r}
set.seed(123)
slvClust1ExIndx2 = sample(which(kmeansClust3Index==1), 2)
# 180 179 
#  75  74 
slvClust2ExIndx2 = sample(which(kmeansClust3Index==2), 5)
# 111 173 130 148 149 
#   6  68  25  43  44
slvClust3ExIndx2 = sample(which(kmeansClust3Index==3), 3)
# 120 168 135 
#  15  63  30 
```

```{r}
rowExIndx2 = c(slvClust1ExIndx2, slvClust2ExIndx2, slvClust3ExIndx2)
slvEx2.df = sample.df[rowExIndx2 ,c("HTN3", "MUC7", "PRB4", "SMR3B" )]
slvEx2.df
```

## Partition 1

```{r ex2_part1_clust1}
sum(slvEx2.df)
prod(dim(slvEx2.df))
```


```{r ex2_part1_calc_lik}
ex2.expt1 = sum(log(1:13)) - sum(log(31:44))
ex2.ans1 = log(calcLikIntAllPart(eltsAllPartSet = list(list(c(1:4))), 
                         sample = slvEx2.df, 
                         alphaC = 3, 
                         betaC = 2))

print(ex2.expt1, digit = 12)
print(ex2.ans1, digit = 12)

ex2.expt1 - ex2.ans1 
all(abs(ex2.expt1 - ex2.ans1) < 1e-10)
```


```{r ex2_part1_calc_mdp}
ex2.mdp.expt1 = 35/(3 * 17 * 19)
ex2.mdp.ans1 = calcLogMDPColPrior(alpha = 16, 
                                  setList = list(c(1, 2, 3, 4)), 
                                  setCountMax = 4)

abs(ex2.mdp.expt1 - ex2.mdp.ans1)/max(c(ex2.mdp.expt1, ex2.mdp.ans1))
abs((ex2.mdp.expt1 - ex2.mdp.ans1)/max(c(ex2.mdp.expt1, ex2.mdp.ans1))) < 1e-10
abs((ex2.mdp.expt1 - ex2.mdp.ans1)) < 1e-10
```

## Partition 2

Partition pattern: (1, 1, 1, 2)

```{r ex2_part2_clust1}
sum(slvEx2.df[, 1:3])
prod(dim(slvEx2.df[, 1:3]))
```


```{r ex2_part2_clust2}
sum(slvEx2.df[,4])
length(slvEx2.df[,4])
```

```{r ex2_part2_calc_lik}
ex2.expt2.clust1.log.lik = sum(log(1:12)) - sum(log(22:34))
ex2.expt2.clust2.log.lik = -(log(6) + log(13) + log(14))

ex2.expt2 = ex2.expt2.clust1.log.lik + ex2.expt2.clust2.log.lik
ex2.ans2 = log(calcLikIntAllPart(eltsAllPartSet = list(list(c(1:3), c(4))), 
                         sample = slvEx2.df, 
                         alphaC = 3, 
                         betaC = 2))

print(ex2.expt2, digit = 12)
print(ex2.ans2, digit = 12)

ex2.expt2 - ex2.ans2
all(abs(ex2.expt2 - ex2.ans2) < 1e-10)
```


```{r ex2_part2_calc_mdp}
ex2.mdp.expt2 = 20/(17 * 19)
ex2.mdp.ans2 = calcLogMDPColPrior(alpha = 16, 
                                  setList = list(c(1, 2, 3), c(4)), 
                                  setCountMax = 4)

abs(ex2.mdp.expt2 - ex2.mdp.ans2)/max(c(ex2.mdp.expt2, ex2.mdp.ans2))
abs((ex2.mdp.expt2 - ex2.mdp.ans2)/max(c(ex2.mdp.expt2, ex2.mdp.ans2))) < 1e-10
abs((ex2.mdp.expt2 - ex2.mdp.ans2)) < 1e-10
```

## Partition 3

Partition pattern: (1, 1, 2, 1)

```{r ex2_part3_clust1}
sum(slvEx2.df[, c(1, 2, 4)])
prod(dim(slvEx2.df[, c(1, 2, 4)]))
```


```{r ex2_part3_clust2}
sum(slvEx2.df[,3])
length(slvEx2.df[,3])
```

```{r ex2_part3_calc_lik}
ex2.expt3.clust1.log.lik = sum(log(1:5)) - sum(log(29:34))
ex2.expt3.clust2.log.lik = -(log(5) + log(11) + log(13) + log(14))

ex2.expt3 = ex2.expt3.clust1.log.lik + ex2.expt3.clust2.log.lik
ex2.ans3 = log(calcLikIntAllPart(eltsAllPartSet = list(list(c(1,2,4), c(3))), 
                         sample = slvEx2.df, 
                         alphaC = 3, 
                         betaC = 2))

print(ex2.expt3, digit = 12)
print(ex2.ans3, digit = 12)

ex2.expt3 - ex2.ans3
all(abs(ex2.expt3 - ex2.ans3) < 1e-10)
```

```{r ex2_part3_calc_mdp}
ex2.mdp.expt3 = 20/(17 * 19)
ex2.mdp.ans3 = calcLogMDPColPrior(alpha = 16, 
                                  setList = list(c(1, 2, 4), c(3)), 
                                  setCountMax = 4)

abs(ex2.mdp.expt3 - ex2.mdp.ans3)/min(c(ex2.mdp.expt3, ex2.mdp.ans3))
abs((ex2.mdp.expt3 - ex2.mdp.ans3)/min(c(ex2.mdp.expt3, ex2.mdp.ans3))) < 1e-10
abs((ex2.mdp.expt3 - ex2.mdp.ans3)) < 1e-10
```

## Partition 4

Partition pattern: (1, 1, 2, 2)

```{r ex2_part4_clust1}
sum(slvEx2.df[, c(1, 2)])
prod(dim(slvEx2.df[, c(1, 2)]))
```


```{r ex2_part4_clust2}
sum(slvEx2.df[, c(3, 4)])
prod(dim(slvEx2.df[, c(3, 4)]))
```

```{r ex2_part4_calc_lik}
ex2.expt4.clust1.log.lik = - sum(log(20:23))
ex2.expt4.clust2.log.lik = sum(log(1:10)) - sum(log(14:24))

ex2.expt4 = ex2.expt4.clust1.log.lik + ex2.expt4.clust2.log.lik
ex2.ans4 = log(calcLikIntAllPart(eltsAllPartSet = list(list(c(1,2), c(3,4))), 
                         sample = slvEx2.df, 
                         alphaC = 3, 
                         betaC = 2))

print(ex2.expt4, digit = 12)
print(ex2.ans4, digit = 12)

ex2.expt4 - ex2.ans4
all(abs(ex2.expt4 - ex2.ans4) < 1e-10)
```


```{r ex2_part4_calc_mdp}
ex2.mdp.expt4 = 50/(3 * 17 * 19)
ex2.mdp.ans4 = calcLogMDPColPrior(alpha = 16, 
                                  setList = list(c(1, 2), c(3, 4)), 
                                  setCountMax = 4)

abs(ex2.mdp.expt4 - ex2.mdp.ans4)/min(c(ex2.mdp.expt4, ex2.mdp.ans4))
abs((ex2.mdp.expt4 - ex2.mdp.ans4)/min(c(ex2.mdp.expt4, ex2.mdp.ans4))) < 1e-10
abs((ex2.mdp.expt4 - ex2.mdp.ans4)) < 1e-10
```

## Partition 5

Partition pattern: (1, 1, 2, 3)

```{r ex2_part5_clust1}
sum(slvEx2.df[, c(1, 2)])
prod(dim(slvEx2.df[, c(1, 2)]))
```


```{r ex2_part5_clust2}
sum(slvEx2.df[, 3])
length(slvEx2.df[, 3])
```

```{r ex2_part5_clust3}
sum(slvEx2.df[, 4])
length(slvEx2.df[,4])
```

```{r ex2_part5_calc_lik}
ex2.expt5.clust1.log.lik = - sum(log(20:23))
ex2.expt5.clust2.log.lik = - sum(log(c(5, 11, 13, 14)))
ex2.expt5.clust3.log.lik = - sum(log(c(6, 13, 14)))

ex2.expt5 = ex2.expt5.clust1.log.lik + ex2.expt5.clust2.log.lik + ex2.expt5.clust3.log.lik
ex2.ans5 = log(calcLikIntAllPart(eltsAllPartSet = list(list(c(1,2), c(3), c(4))), 
                         sample = slvEx2.df, 
                         alphaC = 3, 
                         betaC = 2))

print(ex2.expt5, digit = 12)
print(ex2.ans5, digit = 12)

ex2.expt5 - ex2.ans5
all(abs(ex2.expt5 - ex2.ans5) < 1e-10)
```


```{r ex2_part5_calc_mdp}
ex2.mdp.expt5 = 80/(3 * 17 * 19)
ex2.mdp.ans5 = calcLogMDPColPrior(alpha = 16, 
                                  setList = list(c(1, 2), c(3), c(4)), 
                                  setCountMax = 4)

abs(ex2.mdp.expt5 - ex2.mdp.ans5)/min(c(ex2.mdp.expt5, ex2.mdp.ans5))
abs((ex2.mdp.expt5 - ex2.mdp.ans5)/min(c(ex2.mdp.expt5, ex2.mdp.ans5))) < 1e-10
abs((ex2.mdp.expt5 - ex2.mdp.ans5)) < 1e-10
```

## Partition 6

Partition pattern: (1, 2, 1, 1)

```{r ex2_part6_clust1}
sum(slvEx2.df[, c(1, 3, 4)])
prod(dim(slvEx2.df[, c(1, 3, 4)]))
```


```{r ex2_part6_clust2}
sum(slvEx2.df[, 2])
length(slvEx2.df[, 2])
```

```{r ex2_part6_calc_lik}
ex2.expt6.clust1.log.lik = sum(log(1:13)) - sum(log(21:34))
ex2.expt6.clust2.log.lik = -(log(13) + log(14))

ex2.expt6 = ex2.expt6.clust1.log.lik + ex2.expt6.clust2.log.lik
ex2.ans6 = log(calcLikIntAllPart(eltsAllPartSet = list(list(c(1,3,4), c(2))), 
                         sample = slvEx2.df, 
                         alphaC = 3, 
                         betaC = 2))

print(ex2.expt6, digit = 12)
print(ex2.ans6, digit = 12)

ex2.expt6 - ex2.ans6
all(abs(ex2.expt6 - ex2.ans6) < 1e-10)
```


```{r ex2_part6_calc_mdp}
ex2.mdp.expt6 = 20/(17 * 19)
ex2.mdp.ans6 = calcLogMDPColPrior(alpha = 16, 
                                  setList = list(c(1, 3, 4), c(2)), 
                                  setCountMax = 4)

abs(ex2.mdp.expt6 - ex2.mdp.ans6)/min(c(ex2.mdp.expt6, ex2.mdp.ans6))
abs((ex2.mdp.expt6 - ex2.mdp.ans6)/min(c(ex2.mdp.expt6, ex2.mdp.ans6))) < 1e-10
abs((ex2.mdp.expt6 - ex2.mdp.ans6)) < 1e-10
```

## Partition 7

Partition: (1, 2, 1, 2)


```{r ex2_part7_clust1}
sum(slvEx2.df[, c(1, 3)])
prod(dim(slvEx2.df[, c(1, 3)]))
```


```{r ex2_part7_clust2}
sum(slvEx2.df[, c(2, 4)])
prod(dim(slvEx2.df[, c(2, 4)]))
```

```{r ex2_part7_calc_lik}
ex2.expt7.clust1.log.lik = sum(log(1:11)) - sum(log(13:24))
ex2.expt7.clust2.log.lik = -sum(log(c(11, 23, 24)))

ex2.expt7 = ex2.expt7.clust1.log.lik + ex2.expt7.clust2.log.lik
ex2.ans7 = log(calcLikIntAllPart(eltsAllPartSet = list(list(c(1,3), c(2,4))), 
                         sample = slvEx2.df, 
                         alphaC = 3, 
                         betaC = 2))

print(ex2.expt7, digit = 12)
print(ex2.ans7, digit = 12)

ex2.expt7 - ex2.ans7
all(abs(ex2.expt7 - ex2.ans7) < 1e-10)
```


```{r ex2_part7_calc_mdp}
ex2.mdp.expt7 = 50/(3 * 17 * 19)
ex2.mdp.ans7 = calcLogMDPColPrior(alpha = 16, 
                                  setList = list(c(1, 3), c(2, 4)), 
                                  setCountMax = 4)

abs(ex2.mdp.expt7 - ex2.mdp.ans7)/min(c(ex2.mdp.expt7, ex2.mdp.ans7))
abs((ex2.mdp.expt7 - ex2.mdp.ans7)/min(c(ex2.mdp.expt7, ex2.mdp.ans7))) < 1e-10
abs((ex2.mdp.expt7 - ex2.mdp.ans7)) < 1e-10
```

## Partition 8

Partition pattern: (1, 2, 1, 3)

```{r ex2_part8_clust1}
sum(slvEx2.df[, c(1, 3)])
prod(dim(slvEx2.df[, c(1, 3)]))
```


```{r ex2_part8_clust2}
sum(slvEx2.df[, 2])
length(slvEx2.df[, 2])
```

```{r ex2_part8_clust3}
sum(slvEx2.df[, 4])
length(slvEx2.df[,4])
```

```{r ex2_part8_calc_lik}
ex2.expt8.clust1.log.lik = sum(log(1:11)) - sum(log(13:24))
ex2.expt8.clust2.log.lik = - (log(13) + log(14))
ex2.expt8.clust3.log.lik = - sum(log(c(6, 13, 14)))

ex2.expt8 = ex2.expt8.clust1.log.lik + ex2.expt8.clust2.log.lik + ex2.expt8.clust3.log.lik
ex2.ans8 = log(calcLikIntAllPart(eltsAllPartSet = list(list(c(1,3), c(2), c(4))), 
                         sample = slvEx2.df, 
                         alphaC = 3, 
                         betaC = 2))

print(ex2.expt8, digit = 12)
print(ex2.ans8, digit = 12)

ex2.expt8 - ex2.ans8
all(abs(ex2.expt8 - ex2.ans8) < 1e-10)
```


```{r ex2_part8_calc_mdp}
ex2.mdp.expt8 = 80/(3 * 17 * 19)
ex2.mdp.ans8 = calcLogMDPColPrior(alpha = 16, 
                                  setList = list(c(1, 3), c(2), c(4)), 
                                  setCountMax = 4)

abs(ex2.mdp.expt8 - ex2.mdp.ans8)/min(c(ex2.mdp.expt8, ex2.mdp.ans8))
abs((ex2.mdp.expt8 - ex2.mdp.ans8)/min(c(ex2.mdp.expt8, ex2.mdp.ans8))) < 1e-10
abs((ex2.mdp.expt8 - ex2.mdp.ans8)) < 1e-10
```

# Partition 9

Partition: (1, 2, 2, 1)


```{r ex2_part9_clust1}
sum(slvEx2.df[, c(1, 4)])
prod(dim(slvEx2.df[, c(1, 4)]))
```


```{r ex2_part9_clust2}
sum(slvEx2.df[, c(2, 3)])
prod(dim(slvEx2.df[, c(2, 3)]))
```

```{r ex2_part9_calc_lik}
ex2.expt9.clust1.log.lik = sum(log(1:5)) - sum(log(19:24))
ex2.expt9.clust2.log.lik = sum(log(1:9)) - sum(log(15:24))

ex2.expt9 = ex2.expt9.clust1.log.lik + ex2.expt9.clust2.log.lik
ex2.ans9 = log(calcLikIntAllPart(eltsAllPartSet = list(list(c(1,4), c(2,3))), 
                         sample = slvEx2.df, 
                         alphaC = 3, 
                         betaC = 2))

print(ex2.expt9, digit = 12)
print(ex2.ans9, digit = 12)

ex2.expt9 - ex2.ans9
all(abs(ex2.expt9 - ex2.ans9) < 1e-10)
```



```{r ex2_part9_calc_mdp}
ex2.mdp.expt9 = 50/(3 * 17 * 19)
ex2.mdp.ans9 = calcLogMDPColPrior(alpha = 16, 
                                  setList = list(c(1, 4), c(2, 3)), 
                                  setCountMax = 4)

abs(ex2.mdp.expt9 - ex2.mdp.ans9)/min(c(ex2.mdp.expt9, ex2.mdp.ans9))
abs((ex2.mdp.expt9 - ex2.mdp.ans9)/min(c(ex2.mdp.expt9, ex2.mdp.ans9))) < 1e-10
abs((ex2.mdp.expt9 - ex2.mdp.ans9)) < 1e-10
```

## Partition 10

Partition: (1, 2, 2, 2)



```{r ex2_part10_clust1}
sum(slvEx2.df[, 1])
length(slvEx2.df[, 1])
```


```{r ex2_part10_clust2}
sum(slvEx2.df[, 2:4])
prod(dim(slvEx2.df[, 2:4]))
```

```{r ex2_part10_calc_lik}
ex2.expt10.clust1.log.lik = -sum(log(5) + log(11) + log(13) + log(14))
ex2.expt10.clust2.log.lik = sum(log(1:10)) - sum(log(24:34))

ex2.expt10 = ex2.expt10.clust1.log.lik + ex2.expt10.clust2.log.lik
ex2.ans10 = log(calcLikIntAllPart(eltsAllPartSet = list(list(c(1), c(2:4))), 
                         sample = slvEx2.df, 
                         alphaC = 3, 
                         betaC = 2))

print(ex2.expt10, digit = 12)
print(ex2.ans10, digit = 12)

ex2.expt10 - ex2.ans10
all(abs(ex2.expt10 - ex2.ans10) < 1e-10)
```

```{r ex2_part10_calc_mdp}
ex2.mdp.expt10 = 20/(17 * 19)
ex2.mdp.ans10 = calcLogMDPColPrior(alpha = 16, 
                                  setList = list(c(1), c(2, 3, 4)), 
                                  setCountMax = 4)

abs(ex2.mdp.expt10 - ex2.mdp.ans10)/min(c(ex2.mdp.expt10, ex2.mdp.ans10))
abs((ex2.mdp.expt10 - ex2.mdp.ans10)/min(c(ex2.mdp.expt10, ex2.mdp.ans10))) < 1e-10
abs((ex2.mdp.expt10 - ex2.mdp.ans10)) < 1e-10
```

## Partition 11

Partition: (1, 2, 2, 3)

```{r ex2_part11_clust1}
sum(slvEx2.df[, 1])
length(slvEx2.df[, 1])
```


```{r ex2_part11_clust2}
sum(slvEx2.df[, c(2, 3)])
prod(dim(slvEx2.df[, c(2, 3)]))

```

```{r ex2_part11_clust3}
sum(slvEx2.df[, 4])
length(slvEx2.df[,4])
```

```{r ex2_part11_calc_lik}
ex2.expt11.clust1.log.lik = -sum(log(c(5, 11, 13, 14)))
ex2.expt11.clust2.log.lik = sum(log(1:9)) - sum(log(15:24))
ex2.expt11.clust3.log.lik = -sum(log(c(6, 13, 14)))

ex2.expt11 = ex2.expt11.clust1.log.lik + 
  ex2.expt11.clust2.log.lik + 
  ex2.expt11.clust3.log.lik
ex2.ans11 = log(calcLikIntAllPart(eltsAllPartSet = list(list(c(1), c(2, 3), c(4))), 
                         sample = slvEx2.df, 
                         alphaC = 3, 
                         betaC = 2))

print(ex2.expt11, digit = 12)
print(ex2.ans11, digit = 12)

ex2.expt11 - ex2.ans11
all(abs(ex2.expt11 - ex2.ans11) < 1e-10)
```



```{r ex2_part11_calc_mdp}
ex2.mdp.expt11 = 80/(3 * 17 * 19)
ex2.mdp.ans11 = calcLogMDPColPrior(alpha = 16, 
                                  setList = list(c(1), c(2, 3), c(4)), 
                                  setCountMax = 4)

abs(ex2.mdp.expt11 - ex2.mdp.ans11)/min(c(ex2.mdp.expt11, ex2.mdp.ans11))
abs((ex2.mdp.expt11 - ex2.mdp.ans11)/min(c(ex2.mdp.expt11, ex2.mdp.ans11))) < 1e-10
abs((ex2.mdp.expt11 - ex2.mdp.ans11)) < 1e-10
```

## Partition 12

Partition: (1, 2, 3, 1)

```{r ex2_part12_clust1}
sum(slvEx2.df[, c(1, 4)])
prod(dim(slvEx2.df[, c(1, 4)]))
```


```{r ex2_part12_clust2}
sum(slvEx2.df[, 2])
length(slvEx2.df[, 2])
```

```{r ex2_part12_clust3}
sum(slvEx2.df[, 3])
length(slvEx2.df[, 3])
```

```{r ex2_part12_calc_lik}
ex2.expt12.clust1.log.lik = sum(log(1:5)) - sum(log(19:24))
ex2.expt12.clust2.log.lik = - sum(log(13) + log(14))
ex2.expt12.clust3.log.lik = -sum(log(c(5, 11, 13, 14)))

ex2.expt12 = ex2.expt12.clust1.log.lik + 
  ex2.expt12.clust2.log.lik + 
  ex2.expt12.clust3.log.lik
ex2.ans12 = log(calcLikIntAllPart(eltsAllPartSet = list(list(c(1, 4), c(2), c(3))), 
                         sample = slvEx2.df, 
                         alphaC = 3, 
                         betaC = 2))

print(ex2.expt12, digit = 12)
print(ex2.ans12, digit = 12)

ex2.expt12 - ex2.ans12
all(abs(ex2.expt12 - ex2.ans12) < 1e-10)
```



```{r ex2_part12_calc_mdp}
ex2.mdp.expt12 = 80/(3 * 17 * 19)
ex2.mdp.ans12 = calcLogMDPColPrior(alpha = 16, 
                                  setList = list(c(1, 4), c(2), c(3)), 
                                  setCountMax = 4)

abs(ex2.mdp.expt12 - ex2.mdp.ans12)/min(c(ex2.mdp.expt12, ex2.mdp.ans12))
abs((ex2.mdp.expt12 - ex2.mdp.ans12)/min(c(ex2.mdp.expt12, ex2.mdp.ans12))) < 1e-10
abs((ex2.mdp.expt12 - ex2.mdp.ans12)) < 1e-10
```

## Partition 13

Partition: (1, 2, 3, 2)


```{r ex2_part13_clust1}
sum(slvEx2.df[, 1])
length(slvEx2.df[, 1])
```


```{r ex2_part13_clust2}

sum(slvEx2.df[, c(2, 4)])
prod(dim(slvEx2.df[, c(2, 4)]))
```

```{r ex2_part13_clust3}
sum(slvEx2.df[, 3])
length(slvEx2.df[, 3])
```

```{r ex2_part13_calc_lik}
ex2.expt13.clust1.log.lik = -sum(log(c(5, 11, 13, 14)))
ex2.expt13.clust2.log.lik = - (log(11) + log(23) + log(24))
ex2.expt13.clust3.log.lik = -sum(log(c(5, 11, 13, 14)))

ex2.expt13 = ex2.expt13.clust1.log.lik + 
  ex2.expt13.clust2.log.lik + 
  ex2.expt13.clust3.log.lik
ex2.ans13 = log(calcLikIntAllPart(eltsAllPartSet = list(list(c(1), c(2, 4), c(3))), 
                         sample = slvEx2.df, 
                         alphaC = 3, 
                         betaC = 2))

print(ex2.expt13, digit = 12)
print(ex2.ans13, digit = 12)

ex2.expt13 - ex2.ans13
all(abs(ex2.expt13 - ex2.ans13) < 1e-10)
```


```{r ex2_part13_calc_mdp}
ex2.mdp.expt13 = 80/(3 * 17 * 19)
ex2.mdp.ans13 = calcLogMDPColPrior(alpha = 16, 
                                  setList = list(c(1), c(2, 4), c(3)), 
                                  setCountMax = 4)

abs(ex2.mdp.expt13 - ex2.mdp.ans13)/min(c(ex2.mdp.expt13, ex2.mdp.ans13))
abs((ex2.mdp.expt13 - ex2.mdp.ans13)/min(c(ex2.mdp.expt13, ex2.mdp.ans13))) < 1e-10
abs((ex2.mdp.expt13 - ex2.mdp.ans13)) < 1e-10
```

## Partition 14

Partition: (1, 2, 3, 3)

```{r ex2_part14_clust1}
sum(slvEx2.df[, 1])
length(slvEx2.df[, 1])
```


```{r ex2_part14_clust2}
sum(slvEx2.df[, 2])
length(slvEx2.df[, 2])
```

```{r ex2_part14_clust3}
sum(slvEx2.df[, c(3, 4)])
prod(dim(slvEx2.df[, c(3, 4)]))
```

```{r ex2_part14_calc_lik}
ex2.expt14.clust1.log.lik = -sum(log(c(5, 11, 13, 14)))
ex2.expt14.clust2.log.lik = - (log(13) + log(14))
ex2.expt14.clust3.log.lik = sum(log(1:10)) -sum(log(c(14:24)))

ex2.expt14 = ex2.expt14.clust1.log.lik + 
  ex2.expt14.clust2.log.lik + 
  ex2.expt14.clust3.log.lik
ex2.ans14 = log(calcLikIntAllPart(eltsAllPartSet = list(list(c(1), c(2), c(3, 4))), 
                         sample = slvEx2.df, 
                         alphaC = 3, 
                         betaC = 2))

print(ex2.expt14, digit = 12)
print(ex2.ans14, digit = 12)

ex2.expt14 - ex2.ans14
all(abs(ex2.expt14 - ex2.ans14) < 1e-10)
```



```{r ex2_part14_calc_mdp}
ex2.mdp.expt14 = 80/(3 * 17 * 19)
ex2.mdp.ans14 = calcLogMDPColPrior(alpha = 16, 
                                  setList = list(c(1), c(2), c(3, 4)), 
                                  setCountMax = 4)

abs(ex2.mdp.expt14 - ex2.mdp.ans14)/min(c(ex2.mdp.expt14, ex2.mdp.ans14))
abs((ex2.mdp.expt14 - ex2.mdp.ans14)/min(c(ex2.mdp.expt14, ex2.mdp.ans14))) < 1e-10
abs((ex2.mdp.expt14 - ex2.mdp.ans14)) < 1e-10
```

## Partition 15


Partition: (1, 2, 3, 4)

```{r ex2_part15_clust1}
sum(slvEx2.df[, 1])
length(slvEx2.df[, 1])
```


```{r ex2_part15_clust2}
sum(slvEx2.df[, 2])
length(slvEx2.df[, 2])
```

```{r ex2_part15_clust3}
sum(slvEx2.df[, 3])
length(slvEx2.df[, 3])
```

```{r ex2_part15_clust4}
sum(slvEx2.df[, 4])
length(slvEx2.df[, 4])
```

```{r ex2_part15_calc_lik}
ex2.expt15.clust1.log.lik = -sum(log(c(5, 11, 13, 14)))
ex2.expt15.clust2.log.lik = - (log(13) + log(14))
ex2.expt15.clust3.log.lik = -sum(log(c(5, 11, 13, 14)))
ex2.expt15.clust4.log.lik = -sum(log(c(6, 13, 14)))

ex2.expt15 = ex2.expt15.clust1.log.lik + 
  ex2.expt15.clust2.log.lik + 
  ex2.expt15.clust3.log.lik + 
  ex2.expt15.clust4.log.lik
ex2.ans15 = log(calcLikIntAllPart(eltsAllPartSet = list(list(c(1), c(2), c(3), c(4))), 
                         sample = slvEx2.df, 
                         alphaC = 3, 
                         betaC = 2))

print(ex2.expt15, digit = 12)
print(ex2.ans15, digit = 12)

ex2.expt15 - ex2.ans15
all(abs(ex2.expt15 - ex2.ans15) < 1e-10)
```



```{r ex2_part15_calc_mdp}
ex2.mdp.expt15 = 64/(3 * 17 * 19)
ex2.mdp.ans15 = calcLogMDPColPrior(alpha = 16, 
                                  setList = list(c(1), c(2), c(3), c(4)), 
                                  setCountMax = 4)

abs(ex2.mdp.expt15 - ex2.mdp.ans15)/min(c(ex2.mdp.expt15, ex2.mdp.ans15))
abs((ex2.mdp.expt15 - ex2.mdp.ans15)/min(c(ex2.mdp.expt15, ex2.mdp.ans15))) < 1e-10
abs((ex2.mdp.expt15 - ex2.mdp.ans15)) < 1e-10
```